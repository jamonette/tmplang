package com.jamonette.tmplang

sealed trait Expression extends ExpressionOrSpecialForm
sealed trait SpecialForm extends ExpressionOrSpecialForm
sealed trait Value extends Expression
sealed trait Operator extends Expression

////////////////////////////////////////////////////////////////////////////////////////////
///// Special forms ///////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////

case class FunctionCall(function: ExpressionOrSpecialForm, argument: ExpressionOrSpecialForm) extends SpecialForm
case class If(condition: ExpressionOrSpecialForm, ifTrue: ExpressionOrSpecialForm, ifFalse: ExpressionOrSpecialForm) extends SpecialForm
case class Let(variable: VariableDefinition, valueToBind: ExpressionOrSpecialForm, toEvaluate: ExpressionOrSpecialForm) extends SpecialForm
case class OperatorCall(operator: Operator, list: ListOrReference) extends SpecialForm
case class VariableReference(variableName: String) extends SpecialForm with ListOrReference

case class VariableDefinition(variableName: String)

////////////////////////////////////////////////////////////////////////////////////////////
///// Expression types ////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////

case class FunctionDef(formalParameter: VariableDefinition, functionBody: ExpressionOrSpecialForm) extends Expression
case class ListType(items: Seq[ExpressionOrSpecialFormOrReference]) extends Expression with ListOrReference

////////////////////////////////////////////////////////////////////////////////////////////
///// Value types /////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////

case class NumberLiteral(n: Int) extends Value
case class StringLiteral(s: String) extends Value

sealed trait BooleanValue extends Value
case class True() extends BooleanValue
case class False() extends BooleanValue

////////////////////////////////////////////////////////////////////////////////////////////
///// Numerical operators /////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////

// NOTE: never add the modulo operator
sealed trait NumericalOperator extends Operator
case class Add() extends NumericalOperator
case class Subtract() extends NumericalOperator
case class Multiply() extends NumericalOperator
case class Divide() extends NumericalOperator

////////////////////////////////////////////////////////////////////////////////////////////
///// List operators //////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////

sealed trait ListOperator extends Operator
case class First() extends ListOperator
case class Rest() extends ListOperator
case class Concat() extends ListOperator

////////////////////////////////////////////////////////////////////////////////////////////
///// Comparison operators ////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////

sealed trait ComparisonOperator extends Operator
case class Equals() extends ComparisonOperator

////////////////////////////////////////////////////////////////////////////////////////////
///// Union types /////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////

// REFACTOR: better names for these
sealed trait ExpressionOrSpecialFormOrReference
sealed trait ExpressionOrSpecialForm extends ExpressionOrSpecialFormOrReference
sealed trait ListOrReference
